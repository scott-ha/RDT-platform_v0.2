{"version":3,"sources":["../../src/client/clientEntryPoint.js"],"names":["log","host","socket","cnt","$","document","ready","connect","WebSocket","getElementById","innerHTML","readyState","window","W_fr","onopen","send","onmessage","event","msg","String","data","str","split","length","val","isNaN","W_speed","parseInt","W_dir","onclose","close","onerror","click","load","qsOptions","querystring","parse","location","search","defaults","traceLevel","Lib","Trace","TRACE_NONE","delayInputCount","scheduler","syncOptions","sync","localObjBending","remoteObjBending","bendingIncrements","options","Object","assign","gameEngine","WiggleGameEngine","clientEngine","WiggleClientEngine","addEventListener","e","start"],"mappings":"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","sourcesContent":["//\nimport querystring from 'query-string';\nimport { Lib } from 'lance-gg';\nimport WiggleClientEngine from '../client/WiggleClientEngine';\nimport WiggleGameEngine from '../common/WiggleGameEngine';\n\n//---- kong ----\nvar log;\nvar host = \"ws://localhost:5331/echo\";\nvar socket;\nvar cnt = 0;\n//\n$(document).ready(function ()\n{\n    function connect() \n    {\n        socket = new WebSocket(host);\n        log = document.getElementById(\"krlog\");\n        log.innerHTML += \"socket created = \" + socket.readyState + \"<br/>\";\n        window.W_fr = 0;\n\n        socket.onopen = function() {\n            log.innerHTML += \"socket opened = \" + socket.readyState + \"<br/>\";\n            socket.send(\"hello server\");\n        }\n        socket.onmessage = function(event) {\n            cnt++;\n            var msg = new String(event.data);\n            log.innerHTML  = \"RX \" + cnt + \" = \" + msg + \"<br/>\";\n\n            var str = msg.split('V');\n            if (str[1].length != 9) {\n                return;\n            }\n            var val = str[1].split('D');\n            if (isNaN(val[0]) || isNaN(val[1])) {\n                return;\n            }\n            window.W_speed = parseInt(val[0]);\n            window.W_dir = 19 - parseInt(val[1]);\n\n            log.innerHTML += \"speed: \" + window.W_speed + \"<br/>\";\n            log.innerHTML += \"dir: \" + window.W_dir + \"<br/>\";\n            log.innerHTML += \"fr: \" + window.W_fr + \"<br/>\";\n        }\n        socket.onclose = function() {\n            log.innerHTML += \"socket closed = +++++++++++++++++++++++++++++++++++\" + socket.readyState + \"<br/>\";\n            socket.close();\n        }\n        socket.onerror = function() {\n            log.innerHTML += \"socket error = \" + socket.readyState + \"<br/>\";\n        }\n    }\n    $('#krlog').click(function() { connect(); });\n});\n\n$(window).load(function()\n{\n    $('#krlog').click();\n});\n//----\n\nconst qsOptions = querystring.parse(location.search);\n// default options, overwritten by query-string options\n// is sent to both game engine and client engine\nconst defaults = {\n    traceLevel: Lib.Trace.TRACE_NONE,\n    delayInputCount: 5,\n    scheduler: 'render-schedule',\n    syncOptions: {\n        sync: qsOptions.sync || 'extrapolate',\n        localObjBending: 0.8,\n        remoteObjBending: 0.8,\n        bendingIncrements: 6\n    }\n};\nlet options = Object.assign(defaults, qsOptions);\n\n// create a client engine and a game engine\nconst gameEngine = new WiggleGameEngine(options);\nconst clientEngine = new WiggleClientEngine(gameEngine, options);\n\ndocument.addEventListener('DOMContentLoaded', function(e) { clientEngine.start(); });\n\nexport { socket }\n\n//\n"],"file":"clientEntryPoint.js"}